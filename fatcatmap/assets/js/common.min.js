var dye,frame,hide,image_prefix,load_context,map,mapper,onloads,receive,show,stage,_get,_onload,__slice=[].slice;_get=this._get=function $this$_get$($d$$){if($d$$&&null!=$d$$.querySelector)return $d$$;if("string"===typeof $d$$)return"#"===$d$$[0]?document.getElementById($d$$.replace("#","")):document.querySelectorAll($d$$);console.log("_get was asked to retrieve:",$d$$);throw"invalid _get string";};
show=this.show=function $this$show$($d$$,$hidden_only$$){var $el$$,$element$$,$_i$$,$_len$$,$_results$$;$el$$=_get($d$$);null==$el$$.length&&($el$$=[$el$$]);$_results$$=[];$_i$$=0;for($_len$$=$el$$.length;$_i$$<$_len$$;$_i$$++)$element$$=$el$$[$_i$$],$hidden_only$$?$_results$$.push($element$$.classList.remove("hidden")):$_results$$.push($element$$.classList.remove("transparent"));return $_results$$};
hide=this.hide=function $this$hide$($d$$2_el$$){var $element$$,$_i$$,$_len$$,$_results$$;$d$$2_el$$=_get($d$$2_el$$);null==$d$$2_el$$.length&&($d$$2_el$$=[$d$$2_el$$]);$_results$$=[];$_i$$=0;for($_len$$=$d$$2_el$$.length;$_i$$<$_len$$;$_i$$++)$element$$=$d$$2_el$$[$_i$$],$_results$$.push($element$$.classList.add("transparent"));return $_results$$};
dye=function $dye$($d$$,$color$$){var $el$$,$element$$,$_i$$,$_len$$,$_results$$;$el$$=_get($d$$);null==$el$$.length&&($el$$=[$el$$]);$_results$$=[];$_i$$=0;for($_len$$=$el$$.length;$_i$$<$_len$$;$_i$$++)$element$$=$el$$[$_i$$],$_results$$.push($element$$.classList.add("transparent"));return $_results$$};stage=this.stage=_get("#appstage");map=this.map=_get("#map");mapper=this.mapper=_get("#mapper");frame=this.frame=_get("#appframe");image_prefix=this.image_prefix="//deliver.fcm-static.org/image-proxy/providence-clarity/warehouse/raw/govtrack/photos/";
onloads=this.__onload_callbacks=[];
receive=this.receive=function $this$receive$($data$$){var $graph$$,$index$$,$_j_key$$,$_key_iter_key_i_native_suboffset$$,$_i$$,$payload$$,$_len$$,$_k__ref$$,$_len2$$;$payload$$="string"===typeof $data$$?this.payload=JSON.parse($data$$):this.payload=$data$$;$data$$=this.data={};$index$$=this.index={nodes_by_key:{},edges_by_key:{},natives_by_key:{},object_natives:{}};$graph$$=this.graph={nodes:[],edges:[],natives:[]};$_k__ref$$=$payload$$.data.keys;$_key_iter_key_i_native_suboffset$$=$_i$$=0;for($_len$$=
$_k__ref$$.length;$_i$$<$_len$$;$_key_iter_key_i_native_suboffset$$=++$_i$$)$_j_key$$=$_k__ref$$[$_key_iter_key_i_native_suboffset$$],$data$$[$_j_key$$]=$payload$$.data.objects[$_key_iter_key_i_native_suboffset$$];$_len$$=Array($payload$$.graph.natives);$_key_iter_key_i_native_suboffset$$=$_j_key$$=0;for($_len$$=$_len$$.length;$_j_key$$<$_len$$;$_key_iter_key_i_native_suboffset$$=++$_j_key$$)$_i$$=$payload$$.graph.edges+1+$_key_iter_key_i_native_suboffset$$,$_i$$=$index$$.natives_by_key[$payload$$.data.keys[$_i$$]]=
$graph$$.natives.push({key:$payload$$.data.keys[$_i$$],data:$data$$[$payload$$.data.keys[$_i$$]]})-1;for($_key_iter_key_i_native_suboffset$$=-1;$_key_iter_key_i_native_suboffset$$<$payload$$.data.keys.length;)if($_key_iter_key_i_native_suboffset$$++,$_key_iter_key_i_native_suboffset$$<=$payload$$.graph.nodes)$_i$$=$index$$.nodes_by_key[$payload$$.data.keys[$_key_iter_key_i_native_suboffset$$]]=$graph$$.nodes.push({node:{key:$payload$$.data.keys[$_key_iter_key_i_native_suboffset$$],data:$data$$[$payload$$.data.keys[$_key_iter_key_i_native_suboffset$$]]},
"native":$graph$$.natives[$index$$.natives_by_key[$data$$[$payload$$.data.keys[$_key_iter_key_i_native_suboffset$$]]["native"]]]})-1;else if($_key_iter_key_i_native_suboffset$$<=$payload$$.graph.edges){$_len$$=$payload$$.data.objects[$_key_iter_key_i_native_suboffset$$].node;$_j_key$$=$_len$$[0];$_len$$=2<=$_len$$.length?__slice.call($_len$$,1):[];$_k__ref$$=0;for($_len2$$=$_len$$.length;$_k__ref$$<$_len2$$;$_k__ref$$++)$_i$$=$_len$$[$_k__ref$$],null==$index$$.edges_by_key[$payload$$.data.keys[$_key_iter_key_i_native_suboffset$$]]&&
($index$$.edges_by_key[$payload$$.data.keys[$_key_iter_key_i_native_suboffset$$]]=[]),$_i$$=$graph$$.edges.push({edge:{key:$payload$$.data.keys[$_key_iter_key_i_native_suboffset$$],data:$data$$[$payload$$.data.keys[$_key_iter_key_i_native_suboffset$$]]},"native":$graph$$.natives[$index$$.natives_by_key[$data$$[$payload$$.data.keys[$_key_iter_key_i_native_suboffset$$]]["native"]]],source:{index:$index$$.nodes_by_key[$_j_key$$],object:$graph$$.nodes[$index$$.nodes_by_key[$_j_key$$]]},target:{index:$index$$.nodes_by_key[$_i$$],
object:$graph$$.nodes[$index$$.nodes_by_key[$_i$$]]}})-1;$index$$.edges_by_key[$payload$$.data.keys[$_key_iter_key_i_native_suboffset$$]].push($_i$$)}return setTimeout(function(){return this.draw($graph$$)},0)};
load_context=this.load_context=function $this$load_context$($event$$,$data$$){var $_mapper_reveal_context_pagedata$$,$_mapper_queue$$,$_show_queue$$,$_ui_reveal$$;$_show_queue$$=[];$_mapper_queue$$=[];$_mapper_reveal_context_pagedata$$=this.context=$data$$||JSON.parse(document.getElementById("js-context").textContent);console.log("Loading context...",$_mapper_reveal_context_pagedata$$);this.context.services&&(console.log("Loading services...",$_mapper_reveal_context_pagedata$$.services),apptools.rpc.service.factory($_mapper_reveal_context_pagedata$$.services));
this.context.pagedata&&($_mapper_reveal_context_pagedata$$=this.pagedata=JSON.parse(document.getElementById("js-data").textContent),console.log("Detected stapled pagedata...",$_mapper_reveal_context_pagedata$$),this.receive($_mapper_reveal_context_pagedata$$));this.context.session&&(this.context.session.established?(this.session=this.context.session.payload,console.log("Loading existing session...",this.session)):(this.session={authenticated:!1},console.log("Establishing fresh session...",this.session),
$_show_queue$$.push(this._get("#logon"))));$_show_queue$$.push(this._get("#appfooter"));$_show_queue$$.push(this._get("#appstage"));$_mapper_queue$$.push(this._get("#catnip"));$_ui_reveal$$=function($_this$$){return function(){var $element_set$$,$_i$$,$_len$$,$_results$$;console.log("Flushing UI reveal queue...",$_show_queue$$);$_results$$=[];$_i$$=0;for($_len$$=$_show_queue$$.length;$_i$$<$_len$$;$_i$$++)$element_set$$=$_show_queue$$[$_i$$],$_results$$.push($_this$$.show($element_set$$));return $_results$$}}(this);
$_mapper_reveal_context_pagedata$$=function($_this$$){return function(){var $element_set$$,$_i$$,$_len$$,$_results$$;console.log("Flusing mapper reveal queue...",$_mapper_queue$$);$_results$$=[];$_i$$=0;for($_len$$=$_mapper_queue$$.length;$_i$$<$_len$$;$_i$$++)$element_set$$=$_mapper_queue$$[$_i$$],$_results$$.push($_this$$.show($element_set$$));return $_results$$}}(this);setTimeout($_ui_reveal$$,800);setTimeout($_mapper_reveal_context_pagedata$$,500);return this.context};onloads.push(load_context);
_onload=this.onload=function $this$onload$($event$$){var $callback$$,$_i$$,$_len$$,$_ref$$,$_results$$;$_ref$$=this.__onload_callbacks;$_results$$=[];$_i$$=0;for($_len$$=$_ref$$.length;$_i$$<$_len$$;$_i$$++)$callback$$=$_ref$$[$_i$$],$_results$$.push($callback$$($event$$));return $_results$$};
