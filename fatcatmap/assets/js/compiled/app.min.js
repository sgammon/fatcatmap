(function() {function g(a){var b;if(a&&a.querySelector)return a;b=b||document;if("string"===typeof a){if("#"===a.charAt(0))a=document.getElementById(a.slice(1));else{a=b.querySelectorAll(a);b=[];var c;for(c=0;c<a.length;b.push(a[c++]));a=b}return a}throw new TypeError("Invalid document query string.");};var k={context:JSON.parse(g("#js-context").textContent||"{}"),data:JSON.parse(g("#js-data").textContent||"{}")};var l={};function m(a){if(a)for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b])}m.prototype=l;Object.defineProperty(Function.prototype,"client",{value:function(a){var b=this;return function(){return b.apply(new m(a),arguments)}}});Object.defineProperty(Function.prototype,"service",{value:function(a,b){m.prototype[a]=this.client(b);return m.prototype[a]}});
Object.defineProperty(Object.prototype,"service",{value:function(a){var b;if(!a||"string"!==typeof a)throw new TypeError("service() requires a string name.");if(this.constructor!==Object)throw Error("service() can only be invoked on native objects.");for(var c in this)this.hasOwnProperty(c)&&(b=this[c],b instanceof Function&&(this[c]=b.client()));m.prototype[a]=this;return m.prototype[a]}});var n={p:navigator.cookieEnabled,t:2==window.devicePixelRatio,C:!!window.Worker,u:!!window.SharedWorker,v:!!window.WebSocket,w:!!window.EventSource,geo:!!navigator.geolocation,B:0<navigator.maxTouchPoints,history:{j:!!window.history.pushState,hash:!!window.onhashchange},A:{local:!!window.localStorage,session:!!window.sessionStorage,s:!!window.IDBFactory}};function p(a,b){var c=!0;-1===a.indexOf("?")&&(a+="?",c=!1);for(var d in b)b.hasOwnProperty(d)&&(!0===c?a+="&":c=!0,a+=encodeURIComponent(d)+"="+encodeURIComponent(b[d]));return a}function r(a){var b={};a=a.split("?").pop().split("&");for(var c,d,e=0;e<a.length;e++)c=a[e].split("="),d=unescape(c[1]),b[c[0]]="true"===d||"false"===d?Boolean(d):/^\d*$/.test(d)?+d:d;return b}
function s(a){var b=Array.prototype.slice.call(arguments),c=b.shift(),d=[];if(!b.length)return c;"/"===c.charAt(c.length-1)&&(c=c.slice(0,-1));for(d.push(c);b.length;)if(c=b.shift())"/"===c.charAt(0)&&(c=c.slice(1)),"/"===c.charAt(c.length-1)&&(c=c.slice(0,-1)),d.push(c);return d.join("/")};l.data={init:function(){this.a={}},normalize:function(a){if("string"===typeof a)try{a=JSON.parse(a)}catch(b){a={}}return a},watch:function(a,b,c){if(!a)throw Error("services.data.watch() requires a string key.");if(!c){if("function"!==typeof b)throw Error("services.data.watch() requires a watcher function.");c=b;b=null}this.a[a]||(this.a[a]=[]);this.a[a].push(b?c.bind(b):function(a){c.call(a,a)})},unwatch:function(a,b){var c,d;if(this.a[a]){c=this.a[a];if(b)for(d=0;d<c.length;d++){if(b===c[d]){c.splice(d,
1);break}}else c=[];this.a[a]=c}}}.service("data");var t,u,v;t={};u={d:{},e:{},g:{},l:{},object_natives:{}};
l.graph={init:function(a){return v=this.graph.i(this.data.normalize(a))},i:function(a){var b,c,d,e,f,h;if(!a)return v;b=a.graph;a=a.data;v={nodes:[],edges:[],natives:[],origin:b.origin};a.keys.forEach(function(b,c){t[b]=a.objects[c]});b.natives.forEach(function(d){d=b.edges+1+d;var e=a.keys[c];u.l[e]||(u.l[e]=v.natives.push({key:e,data:a.objects[d]})-1)});c=-1;for(h=function(b,d){return function(e){var f;!u.d[b]&&u.d[b][e]&&(f=v.edges.push({edge:{key:d,data:a.objects[c]},b:t[a.objects[c].b],source:u.e[b],
target:u.e[e]})-1,u.g[d].push(f),u.d[b]={},u.d[b][e]=f)}};c++<a.keys.length;)d=a.keys[c],c<=b.nodes?u.e[d]||(u.e[d]=v.nodes.push({node:{key:d,data:t[d]},b:{key:a.objects[c].b,data:t[a.objects[c].b]}})):c<=b.edges&&(u.g[d]||(u.g[d]=[]),e=a.objects[c].node.slice(),f=e.shift(),e.forEach(h(f,d)));return v}}.service("graph");var w,x,y;w=function(a,b,c){var d=new XMLHttpRequest;d.open(a.toUpperCase(),b.c?p(b.url,b.c):b.url,!!c);if(b.headers){a=b.headers;for(var e in a)a.hasOwnProperty(e)&&d.setRequestHeader(e,a[e])}d.data=b.data;c?(d.onerror=c.error,d.onloadend=function(){d.responseJSON=y(d);c.success(d.responseJSON)}):(d.onerror=function(a){d.error=a},d.onloadend=function(){d.responseJSON=y(d)});return d};
x=function(a,b,c){var d="object"===typeof b.data?JSON.stringify(b.data):"string"===typeof b.data?b.data:null==b.data?null:""+b.data;a=w(a,b,c);a.send(d);return a};y=function(a){var b={},c=a.getAllResponseHeaders().split("\n");try{b.data=JSON.parse(a.responseText)}catch(d){b.data=a.responseText||""}b.headers={};for(var e=0;e<c.length;e++)c[e]&&(a=c[e].split(/^([^:]+):\s*/),b.headers[a[1]]=a[2]);return b};
l.http={get:function(a,b){return x("GET",a,b)},delete:function(a,b){return x("DELETE",a,b)},head:function(a,b){return x("HEAD",a,b)},post:function(a,b){return x("POST",a,b)},put:function(a,b){return x("PUT",a,b)},a:function(a,b){return x("PATCH",a,b)},options:function(a,b){return x("OPTIONS",a,b)}}.service("http");var z={f:[],dynamic:[]},A={route:[],routed:[],error:[]},B,D;B=function(a,b,c){function d(a,c){b.args[f.keys[c]]=a}for(var e=0,f,h,q;(f=c[e++])&&f.id<=a;)if(f.a.test(a)){h=!0;a=a.match(f.a).slice(1);a.forEach(d);q=f.handler.call(new m,b);break}return{k:h,response:q}};D=function(a,b){var c=this;c.keys=[];c.id=a.replace(/\/<(\w+)>/,function(a,b,f){c.keys.push(f);return"/(\\w+)"});c.a=new RegExp("^"+c.id+"$");c.handler=b;c.f=0===c.keys.length};
l.router={register:function(a,b){var c=!1,d,e,f,h;d=new D(a,b);f=d.f?z.f:z.dynamic;if(f.length){for(h=0;h<f.length;h++)if(e=f[h],!(e.id<d.id)){f.splice(h,0,d);c=!0;break}!1===c&&f.push(d)}else f.push(d)},route:function(a,b){var c,d,e;b=b||{};b.args={};b.c=b.c||{};c=r(a);for(d in c)c.hasOwnProperty(d)&&(b.c[d]=c[d]);A.route.forEach(function(c){c(a,b)});e=B(a,b,z.f);if(e.k)return e=e.response,A.routed.forEach(function(c){c(a,b,e)}),e;e=B(a,b,z.dynamic);if(e.k)return e=e.response,A.routed.forEach(function(c){c(a,
b,e)}),e;e={status:404};A.error.forEach(function(c){c(a,b,e)});return e},on:function(a,b){A[a]||(A[a]=[]);A[a].push(b)},a:function(a,b){var c;b?(c=A[a].indexOf(b),-1<c&&A[a].splice(c,1)):A[a]=[]},init:function(a,b){for(var c in a)a.hasOwnProperty(c)&&"function"===typeof a[c]&&this.router.register(c,a[c]);b&&b(window.location.pathname.split("?").shift())}}.service("router");l.history={push:n.history.j?function(a,b){window.history.pushState(b,"",a)}:function(){},init:function(){var a=this;a.router.on("routed",function(a,c){"history"!==c.source&&l.history.push(a,c.state)});n.history.j&&(window.onpopstate=function(b){a.router.route(window.location.pathname,{source:"history",state:b.state||{}})});a.init=function(){throw Error("History already started");}}}.service("history");var E;E=function(a,b,c){var d=this;d.name=a;d.config=c;b.forEach(function(a){var b=s("/_rpc/v1/",d.name+"."+a);d[a]=function(a,c){var d={url:b,data:a.data||{},c:a.c||{},headers:a.headers||{}};d.headers.Accept="application/json";d.headers["Content-Type"]="application/json";return this.http.post(d,c)}.client()})};l.rpc={m:function(a){var b=a[0];l.rpc[b]=new E(b,a[1],a[2])},init:function(a){a.forEach(l.rpc.m)}}.service("rpc");var F={};l.template={put:function(a,b){"string"===typeof a&&"string"===typeof b&&(F[a]=b)},get:function(a,b){if("string"!==typeof a||"function"!==typeof b.success||"function"!==typeof b.error)throw new TypeError("template.get() requires a filename and CallbackMap.");return F[a]?b.success({data:F[a]}):this.rpc.content.template({data:{path:a}},b)},has:function(a){return!!F[a]},init:function(a){for(var b in a)a.hasOwnProperty(b)&&"string"===typeof a[b]&&l.template.put(b,a[b])}}.service("template");var G={};function H(a,b){var c=a.replace(".","/")+".html";l.template.get(c,{success:function(d){var e=[],f,h;if("string"!==typeof d.data)return b(!1,d);f=d.data.replace(/v-component=("|')(\w+)\1/g,function(a,b,c){e.push(c);return a});h=e.length;G[a]&&(G[a].options.template=f);l.template.put(c,f);if(0===h)return b();e.forEach(function(a){H(a,function(){h-=1;0===h&&b(f)})})},error:function(a){b(!1,a)}})}
l.view={put:function(a,b){if("string"!==typeof a||"function"!==typeof b)throw new TypeError("services.view.put() takes a string name and constructor.");return G[a]=b},get:function(a){if("string"!==typeof a)throw new TypeError("services.view.get() takes a string name.");return G[a]},init:function(a,b){var c=l.view.get(a);if(!c)throw Error("view.init() cannot be called with unregistered view "+a);H(a,function(d){document.body.innerHTML="";d&&(c.options.template=d);l.view.put(a,c);d=new c({ready:b,el:"body"});
window.__ROOTVIEW=d})}}.service("view");window.__VIEWS=G;var I=Vue.extend({});I.extend=function(a){var b=a.viewname.toLowerCase(),c;if(!b||"string"!==typeof b)throw Error('AppView.extend() requires a "viewname" option to be passed.');a.ready&&(c=a.ready);a.ready=function(){this.$options.handler&&this.$on(this.$options.viewname,this.$options.handler.bind(this));c&&c.call(this)};a=Vue.extend(a);l.view.put(b,a);Vue.component(b,a);return a};I.extend({viewname:"detail",replace:!0,data:{view:"",selected:null},handler:function(a){this.$set("view",a.kind.toLowerCase());this.$set("selected",a)}});I.extend({viewname:"header",replace:!0});I.extend({viewname:"modal",data:{active:!1,message:""}});I.extend({viewname:"stage",replace:!0,data:{active:!0}});I.extend({viewname:"page.map",selectors:{map:"#map",edge:".edge",node:".node"},data:{active:!0,graph:{root:null,force:null,edge:null,line:null,node:null,circle:null},config:{width:0,height:0,force:{alpha:.75,strength:1,friction:.9,theta:.7,gravity:.1,charge:-700,distance:180},origin:{snap:!0,dynamic:!0,position:null},node:{radius:20,classes:["node"]},labels:{enable:!1,distance:0},edge:{width:2,stroke:"#999",classes:["link"]},sprite:{width:60,height:60}}},methods:{toggleSelected:function(){},addSelected:function(){},
browseTo:function(){},draw:function(a){var b,c,d,e,f,h,q,C;this.graph.root?(this.graph.root=null,g(this.$options.selectors.map).innerHTML="",this.draw(a)):(b=this.config,c=this.$options.selectors,d3.scale.category20(),d=this.graph.force=d3.layout.force().size(b.width,b.height).linkDistance(b.force.distance).charge(b.force.charge).linkStrength(b.force.strength).friction(b.force.friction).theta(b.force.theta).gravity(b.force.gravity).alpha(b.force.alpha),e=this.graph.root=d3.select(c.map),f=e.selectAll(c.edge).data(a.edges).enter(),
f=this.graph.edge=f.append("svg:svg").attr("id",function(a){return"edge-"+a.edge.key}),h=this.graph.line=f.append("svg:line").attr("stroke",b.edge.stroke).attr("class",b.edge.classes).style("stroke-width",b.edge.width),c=e.selectAll(c.node).data(a.nodes).enter(),q=c.append("svg:svg").attr("id",function(a){return"group-"+a.node.key}).attr("width",b.sprite.width).attr("height",b.sprite.height).call(d.drag),c=this.graph.node=q.append("svg:g").attr("width",b.sprite.width).attr("height",b.sprite.height).attr("class",
function(a){var b=[];a.b.data.r?(b.push("legislator"),b.push("M"===a.b.data.q?"male":"female"),b.push(Math.ceil(100*Math.random())%2?"democrat":"republican")):(b.push("contributor"),b.push("C"==a.b.data.o?"corporate":"individual"));return b.join(" ")}),this.graph.circle=c.append("svg:circle").attr("r",b.node.radius).attr("cx",b.sprite.width/2).attr("cy",b.sprite.height/2).attr("class",b.node.classes),C=function(c,d,e){b.origin.snap&&e[c].index===a.origin&&b.origin.position(d)},d.on("tick",function(){var a,
c;a=b.width/2;c=b.height/2;b.origin.dynamic&&b.origin.snap&&(this.config.origin.position={x:a+b.sprite.width/2,y:c+b.sprite.height/2});["x","y"].forEach(function(a){q.attr(a,function(){})});["x1","y1","x2","y2"].forEach(function(a){h.attr(a,function(b){C("1"===a[1]?"source":"target",a[0],b)})})}),d.nodes(a.nodes).links(a.edges).start())}},ready:function(){var a=this,b=this.$el.offsetWidth,c=this.$el.offsetHeight;this.config.width=b;this.config.height=c;this.config.origin.position={x:b-30,y:c-30};
window.addEventListener("resize",function(){var b=document.body.clientWidth,c=document.body.clientHeight;a.config.graph.width=b;a.config.graph.height=c;a.graph.root&&a.graph.root.attr("width",b).attr("height",c);a.graph.force&&a.graph.force.size([b,c]).resume()})},handler:function(a){this.draw(a)}});var J=Vue.extend({data:{page:{name:"page.map"},active:!1,modal:null},methods:{route:function(a){if(a.target.hasAttribute("data-route")){var b=a.target.getAttribute("href");a.preventDefault();a.stopPropagation();l.router.route(b)}}}});l.view.put("page",J);var K,L,M;K=[];L=function(){var a=K;K=null;a.forEach(function(a){a()})};
M=function(a,b,c){var d=this;d.n=a;d.session=null;a.session&&a.session.established&&(d.session=a.session.payload);a.services&&a.protocol.rpc.enabled&&d.rpc.init(a.services);a.template.manifest&&d.template.init(a.template.manifest);d.view.init("page",function(){this.$set("active",!0);m.prototype.app=this;L()});d.router.init(c,function(a){d.ready(function(){d.history.init();if(a)return d.router.route(a)})});return this}.client({ready:function(a){if(a){if(!K)return a();K.push(a)}}});window.catnip_beta=M(k.context,k.data,{"/":function(){this.h.page="page.map";this.h.$broadcast("page.map",this.graph.i());return null},"/login":function(){},"/settings":function(){},"/404":function(){},"/<key>":function(a){var b=this;b.data.get(a.args.key,{success:function(a){b.h.$broadcast("detail",a)},error:function(c){a.error=c;b.router.route("/404",a)}});return null},"/<key1>/and/<key2>":function(){}});})();

//# sourceMappingURL=../../../../.develop/maps/fatcatmap/assets/js/app.min.js.map